<!DOCTYPE html>
<html lang="he">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      type="image/x-icon"
      href="https://cdn-icons-png.flaticon.com/512/1372/1372789.png"
    />
    <title>המרת מידות</title>
    <style>
      /* === בסיס משותף - משתנים והגדרות בסיסיות === */
      :root {
        --transition-time: 2s;
        --button-transition: background-color 0.3s;

        /* ערכת צבעים כהה */
        --dark-bg: #000;
        --dark-container-bg: #2d2d2d;
        --dark-text: #ffffff;
        --dark-input-bg: #444;
        --dark-button: #6c5ce7;
        --dark-button-hover: #5a4acb;
        --dark-result: #2fff00;
        --dark-timestamp: #777;
        --dark-border: #444;

        /* ערכת צבעים בהירה */
        --light-bg: #00626d;
        --light-container-bg: #ffffff;
        --light-text: #00626d;
        --light-input-bg: #ffffff;
        --light-button: #00626d;
        --light-button-hover: #0097a7;
        --light-timestamp: #555;
        --light-border: #ddd;
      }

      /* === הגדרות בסיסיות משותפות === */
      body {
        font-family: Arial, sans-serif;
        direction: rtl;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        padding: 10px;
        transition: background-color var(--transition-time) ease,
          color var(--transition-time) ease;
      }

      .container {
        padding: 14px;
        border-radius: 10px;
        box-shadow: -1px -1px 3px 3px rgb(149, 255, 2);
        width: 400px;
        transition: background-color var(--transition-time) ease,
          box-shadow var(--transition-time) ease;
      }

      /* איחוד סגנונות כותרות */
      h1,
      h3 {
        text-align: center;
        font-family: "Secular One", sans-serif;
        font-style: italic;
        line-height: 1;
        transition: color var(--transition-time) ease;
      }

      h1 {
        margin-bottom: 10px;
        margin-top: 0px;
        font-size: 28px;
      }

      h3 {
        margin-bottom: 0px;
        margin-top: 0px;
        font-size: 18px;
      }

      select,
      input,
      button {
        padding: 12px;
        margin-top: 5px;
        border-radius: 4px;
        border-width: 2px;
        border-style: solid;
        box-sizing: border-box;
        width: 100%;
        transition: color var(--transition-time) ease,
          background-color var(--transition-time) ease,
          border-color var(--transition-time) ease;
      }

      button {
        cursor: pointer;
        transition: var(--button-transition);
        font-size: 20px;
      }

      .input-group label {
        margin-bottom: 5px;
        transition: color var(--transition-time) ease;
      }

      /* איחוד סגנונות לתוצאות ושגיאות */
      .result,
      .error,
      .update-time {
        text-align: center;
        margin-top: 8px;
        transition: color var(--transition-time) ease;
      }

      .result,
      .error {
        font-size: 18px;
        font-weight: bold;
      }

      .update-time {
        font-size: 14px;
      }

      .result:empty,
      .error:empty,
      .update-time:empty {
        display: none;
      }

      /* === סגנונות משותפים להיסטוריה === */
      .history {
        margin-top: 0px;
        padding: 10px;
        border-top: 0px solid #ccc;
        text-align: center;
        direction: ltr;
        max-height: 160px;
        overflow-y: auto;
      }

      .history h2 {
        font-size: 18px;
        margin-top: 0px;
      }

      .history ul {
        list-style-type: none;
        padding: 0;
      }

      .history li {
        padding: 5px 0;
        transition: color var(--transition-time) ease;
      }

      .history li div:last-child {
        font-size: 13px;
      }

      /* === סגנונות כפתורים === */
      .button-container {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        margin-top: 10px;
      }

      .button-container button {
        flex: 1;
        padding: 12px;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s;
      }

      /* כפתורי הגדרות */
      .theme-toggle {
        width: 40px !important;
        height: 40px !important;
        position: fixed !important;
        top: 10px !important;
        left: 10px !important;
        border: none !important;
        border-radius: 50% !important;
        background-color: #6c5ce7 !important;
        color: white !important;
        font-size: 22px !important;
        cursor: pointer !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        transition: background-color 0.3s !important;
        box-sizing: border-box !important;
        padding: 0 !important;
        margin: 0 !important;
      }

      .theme-toggle:hover {
        background-color: #5a4acb;
      }

      #clearHistoryButton {
        left: 60px !important;
      }

      /* === ערכת צבעים כהה === */
      body.dark-theme {
        background-color: var(--dark-bg);
        color: var(--dark-text);
      }

      body.dark-theme .container {
        background-color: var(--dark-container-bg);
      }

      body.dark-theme select,
      body.dark-theme input,
      body.dark-theme button {
        border-color: #777;
        background-color: var(--dark-input-bg);
        color: var(--dark-text);
      }

      body.dark-theme button,
      body.dark-theme .button-container button {
        background-color: var(--dark-button);
        color: white;
      }

      body.dark-theme button:hover,
      body.dark-theme .button-container button:hover {
        background-color: var(--dark-button-hover);
      }

      body.dark-theme .result {
        color: var(--dark-result);
      }

      body.dark-theme .error {
        color: #cc0000;
      }

      body.dark-theme .update-time {
        color: var(--dark-timestamp);
      }

      /* איחוד סגנונות היסטוריה בתצוגה כהה */
      body.dark-theme .history li,
      body.dark-theme .history h2 {
        color: var(--dark-text);
      }

      body.dark-theme .history li {
        border-bottom-color: var(--dark-border);
      }

      body.dark-theme .history h2 {
        border-bottom-color: var(--dark-border);
      }

      /* === ערכת צבעים בהירה === */
      body.light-theme {
        background-color: var(--light-bg);
        color: var(--light-text);
      }

      body.light-theme .container {
        background-color: var(--light-container-bg);
      }

      body.light-theme select,
      body.light-theme input {
        background-color: var(--light-input-bg);
        border-color: #777;
        color: var(--light-text);
      }

      body.light-theme button,
      body.light-theme .button-container button {
        background-color: var(--light-button);
        color: white;
      }

      body.light-theme button:hover,
      body.light-theme .button-container button:hover {
        background-color: var(--light-button-hover);
      }

      body.light-theme .error {
        color: #cc0000;
      }

      body.light-theme .update-time {
        color: var(--light-timestamp);
      }

      /* איחוד סגנונות היסטוריה בתצוגה בהירה */
      body.light-theme .history li,
      body.light-theme .history h2 {
        color: var(--light-text);
      }

      body.light-theme .history li {
        border-bottom-color: var(--light-border);
      }

      body.light-theme .history h2 {
        border-bottom-color: #fff;
      }

      /* סטייל למודל היציאה */
      #exit-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 10000;
        display: none;
        justify-content: center;
        align-items: center;
      }

      #exit-modal-content {
        background-color: #5a8de6;
        color: #000;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        max-width: 80%;
        border: 1px solid var(--primary-color);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      #exit-modal h3 {
        margin-bottom: 15px;
        font-weight: bold;
      }

      #exit-modal button {
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        margin: 0 5px;
        cursor: pointer;
        transition: background-color 0.3s;
      }

      #confirm-exit {
        background-color: #ff4444;
        color: #000;
      }

      #cancel-exit {
        background-color: var(--primary-color);
        color: #000;
      }
    </style>
  </head>
  <body class="dark-theme">
    <button id="themeToggle" class="theme-toggle">🌙</button>
    <button id="clearHistoryButton" class="theme-toggle">🗑️</button>

    <div class="container">
      <h1>המרת מידות 🔁</h1>
      <div class="input-group">
        <b><label for="conversionType">סוג ההמרה:</label></b
        ><br />
        <select id="conversionType" onchange="changeConversionType()">
          <option value="currency">מטבעות</option>
          <option value="distance">מידות</option>
          <option value="weight">משקלים</option>
          <option value="temperature">טמפרטורה</option>
          <option value="volume">נפח</option>
          <option value="area">שטח</option>
          <option value="speed">מהירות</option>
          <!-- הוספת קטגוריית מהירות -->
        </select>
      </div>

      <!-- שדות להמרת מטבעות -->
      <div id="currencyFields" class="input-group">
        <b><label for="amount">סכום להמרה:</label></b
        ><br />
        <input type="number" id="amount" placeholder="הכנס סכום" />
      </div>

      <div id="currencyFromFields" class="input-group">
        <b><label for="fromCurrency">ממטבע:</label></b
        ><br />
        <select id="fromCurrency">
          <option value="USD">🇺🇸 דולר אמריקאי (USD)</option>
          <option value="EUR">🇪🇺 יורו (EUR)</option>
          <option value="GBP">🇬🇧 לירה שטרלינג (GBP)</option>
          <option value="JPY">🇯🇵 ין יפני (JPY)</option>
          <option value="AUD">🇦🇺 דולר אוסטרלי (AUD)</option>
          <option value="CAD">🇨🇦 דולר קנדי (CAD)</option>
          <option value="CHF">🇨🇭 פרנק שוויצרי (CHF)</option>
          <option value="CNY">🇨🇳 יואן סיני (CNY)</option>
          <option value="SEK">🇸🇪 קרונה שוודית (SEK)</option>
          <option value="NZD">🇳🇿 דולר ניו זילנדי (NZD)</option>
          <option value="KRW">🇰🇷 וון דרום קוריאני (KRW)</option>
          <option value="SGD">🇸🇬 דולר סינגפורי (SGD)</option>
          <option value="NOK">🇳🇴 קרונה נורווגית (NOK)</option>
          <option value="MXN">🇲🇽 פסו מקסיקני (MXN)</option>
          <option value="INR">🇮🇳 רופי הודי (INR)</option>
          <option value="RUB">🇷🇺 רובל רוסי (RUB)</option>
          <option value="ZAR">🇿🇦 ראנד דרום אפריקאי (ZAR)</option>
          <option value="TRY">🇹🇷 לירה טורקית (TRY)</option>
          <option value="BRL">🇧🇷 ריאל ברזילאי (BRL)</option>
          <option value="TWD">🇹🇼 דולר טייוואני (TWD)</option>
          <option value="DKK">🇩🇰 כתר דני (DKK)</option>
          <option value="PLN">🇵🇱 זלוטי פולני (PLN)</option>
          <option value="THB">🇹🇭 באט תאילנדי (THB)</option>
          <option value="IDR">🇮🇩 רופיה אינדונזית (IDR)</option>
          <option value="HUF">🇭🇺 פורינט הונגרי (HUF)</option>
          <option value="CZK">🇨🇿 קורונה צ'כית (CZK)</option>
          <option value="ILS">🇮🇱 שקל ישראלי (ILS)</option>
          <option value="CLP">🇨🇱 פסו צ'יליאני (CLP)</option>
          <option value="PHP">🇵🇭 פסו פיליפיני (PHP)</option>
          <option value="AED">🇦🇪 דירהם אמירויות (AED)</option>
          <option value="COP">🇨🇴 פסו קולומביאני (COP)</option>
          <option value="SAR">🇸🇦 ריאל סעודי (SAR)</option>
          <option value="MYR">🇲🇾 רינגיט מלזי (MYR)</option>
          <option value="RON">🇷🇴 לאו רומני (RON)</option>
          <option value="ARS">🇦🇷 פסו ארגנטינאי (ARS)</option>
        </select>
      </div>

      <div id="currencyToFields" class="input-group">
        <b><label for="toCurrency">למטבע:</label></b
        ><br />
        <select id="toCurrency">
          <option value="USD">🇺🇸 דולר אמריקאי (USD)</option>
          <option value="EUR">🇪🇺 יורו (EUR)</option>
          <option value="GBP">🇬🇧 לירה שטרלינג (GBP)</option>
          <option value="JPY">🇯🇵 ין יפני (JPY)</option>
          <option value="AUD">🇦🇺 דולר אוסטרלי (AUD)</option>
          <option value="CAD">🇨🇦 דולר קנדי (CAD)</option>
          <option value="CHF">🇨🇭 פרנק שוויצרי (CHF)</option>
          <option value="CNY">🇨🇳 יואן סיני (CNY)</option>
          <option value="SEK">🇸🇪 קרונה שוודית (SEK)</option>
          <option value="NZD">🇳🇿 דולר ניו זילנדי (NZD)</option>
          <option value="KRW">🇰🇷 וון דרום קוריאני (KRW)</option>
          <option value="SGD">🇸🇬 דולר סינגפורי (SGD)</option>
          <option value="NOK">🇳🇴 קרונה נורווגית (NOK)</option>
          <option value="MXN">🇲🇽 פסו מקסיקני (MXN)</option>
          <option value="INR">🇮🇳 רופי הודי (INR)</option>
          <option value="RUB">🇷🇺 רובל רוסי (RUB)</option>
          <option value="ZAR">🇿🇦 ראנד דרום אפריקאי (ZAR)</option>
          <option value="TRY">🇹🇷 לירה טורקית (TRY)</option>
          <option value="BRL">🇧🇷 ריאל ברזילאי (BRL)</option>
          <option value="TWD">🇹🇼 דולר טייוואני (TWD)</option>
          <option value="DKK">🇩🇰 כתר דני (DKK)</option>
          <option value="PLN">🇵🇱 זלוטי פולני (PLN)</option>
          <option value="THB">🇹🇭 באט תאילנדי (THB)</option>
          <option value="IDR">🇮🇩 רופיה אינדונזית (IDR)</option>
          <option value="HUF">🇭🇺 פורינט הונגרי (HUF)</option>
          <option value="CZK">🇨🇿 קורונה צ'כית (CZK)</option>
          <option value="ILS">🇮🇱 שקל ישראלי (ILS)</option>
          <option value="CLP">🇨🇱 פסו צ'יליאני (CLP)</option>
          <option value="PHP">🇵🇭 פסו פיליפיני (PHP)</option>
          <option value="AED">🇦🇪 דירהם אמירויות (AED)</option>
          <option value="COP">🇨🇴 פסו קולומביאני (COP)</option>
          <option value="SAR">🇸🇦 ריאל סעודי (SAR)</option>
          <option value="MYR">🇲🇾 רינגיט מלזי (MYR)</option>
          <option value="RON">🇷🇴 לאו רומני (RON)</option>
          <option value="ARS">🇦🇷 פסו ארגנטינאי (ARS)</option>
        </select>
      </div>

      <!-- שדות להמרת מרחקים -->
      <div id="distanceFields" class="input-group" style="display: none">
        <b><label for="distanceAmount">סכום להמרה:</label></b
        ><br />
        <input type="number" id="distanceAmount" placeholder="הכנס סכום" />
      </div>

      <div id="distanceFromFields" class="input-group" style="display: none">
        <b><label for="fromDistance">ממידה:</label></b
        ><br />
        <select id="fromDistance">
          <option value="Mile">📐 מייל (mi)</option>
          <option value="Kilometer">📐 קילומטר (km)</option>
          <option value="Inch">📐 אינץ' (in)</option>
          <option value="Centimeter">📐 סנטימטר (cm)</option>
          <option value="foot">📐 רגל (ft)</option>
          <option value="Yard">📐 יארד (yd)</option>
          <option value="Millimeter">📐 מילימטר (mm)</option>
        </select>
      </div>

      <div id="distanceToFields" class="input-group" style="display: none">
        <b><label for="toDistance">למידה:</label></b
        ><br />
        <select id="toDistance">
          <option value="Mile">📐 מייל (mi)</option>
          <option value="Kilometer">📐 קילומטר (km)</option>
          <option value="Inch">📐 אינץ' (in)</option>
          <option value="Centimeter">📐 סנטימטר (cm)</option>
          <option value="foot">📐 רגל (ft)</option>
          <option value="Yard">📐 יארד (yd)</option>
          <option value="Millimeter">📐 מילימטר (mm)</option>
        </select>
      </div>

      <!-- שדות להמרת משקלים -->
      <div id="weightFields" class="input-group" style="display: none">
        <b><label for="weightAmount">סכום להמרה:</label></b
        ><br />
        <input type="number" id="weightAmount" placeholder="הכנס סכום" />
      </div>

      <div id="weightFromFields" class="input-group" style="display: none">
        <b><label for="fromWeight">ממשקל:</label></b
        ><br />
        <select id="fromWeight">
          <option value="pd">⚖️ פאונד (pd)</option>
          <option value="kg">⚖️ קילוגרם (kg)</option>
          <option value="oz">⚖️ אונקיה (oz)</option>
          <option value="gr">⚖️ גרם (gr)</option>
        </select>
      </div>

      <div id="weightToFields" class="input-group" style="display: none">
        <b><label for="toWeight">למשקל:</label></b
        ><br />
        <select id="toWeight">
          <option value="pd">⚖️ פאונד (pd)</option>
          <option value="kg">⚖️ קילוגרם (kg)</option>
          <option value="oz">⚖️ אונקיה (oz)</option>
          <option value="gr">⚖️ גרם (gr)</option>
        </select>
      </div>

      <!-- שדות להמרת טמפרטורה -->
      <div id="temperatureFields" class="input-group" style="display: none">
        <b><label for="temperatureAmount">סכום להמרה:</label></b
        ><br />
        <input type="number" id="temperatureAmount" placeholder="הכנס סכום" />
      </div>

      <div id="temperatureFromFields" class="input-group" style="display: none">
        <b><label for="fromTemperature">מטמפרטורה:</label></b
        ><br />
        <select id="fromTemperature">
          <option value="F">🌡️ פרנהייט (°F)</option>
          <option value="C">🌡️ צלזיוס (°C)</option>
          <option value="K">🌡️ קלווין (°K)</option>
        </select>
      </div>

      <div id="temperatureToFields" class="input-group" style="display: none">
        <b><label for="toTemperature">לטמפרטורה:</label></b
        ><br />
        <select id="toTemperature">
          <option value="F">🌡️ פרנהייט (°F)</option>
          <option value="C">🌡️ צלזיוס (°C)</option>
          <option value="K">🌡️ קלווין (°K)</option>
        </select>
      </div>

      <!-- שדות להמרת נפח -->
      <div id="volumeFields" class="input-group" style="display: none">
        <b><label for="volumeAmount">סכום להמרה:</label></b
        ><br />
        <input type="number" id="volumeAmount" placeholder="הכנס סכום" />
      </div>

      <div id="volumeFromFields" class="input-group" style="display: none">
        <b><label for="fromVolume">מנפח:</label></b
        ><br />
        <select id="fromVolume">
          <option value="L">🧴 ליטר (L)</option>
          <option value="mL">🧴 מיליליטר (mL)</option>
          <option value="gal">🧴 גלון (gal)</option>
          <option value="qt">🧴 קוורט (qt)</option>
          <option value="pt">🧴 פינט (pt)</option>
          <option value="fl oz">🧴 אונקיית נוזלים (fl oz)</option>
        </select>
      </div>

      <div id="volumeToFields" class="input-group" style="display: none">
        <b><label for="toVolume">לנפח:</label></b
        ><br />
        <select id="toVolume">
          <option value="L">🧴 ליטר (L)</option>
          <option value="mL">🧴 מיליליטר (mL)</option>
          <option value="gal">🧴 גלון (gal)</option>
          <option value="qt">🧴 קוורט (qt)</option>
          <option value="pt">🧴 פינט (pt)</option>
          <option value="fl oz">🧴 אונקיית נוזלים (fl oz)</option>
        </select>
      </div>

      <!-- שדות להמרת שטח -->
      <div id="areaFields" class="input-group" style="display: none">
        <b><label for="areaAmount">סכום להמרה:</label></b
        ><br />
        <input type="number" id="areaAmount" placeholder="הכנס סכום" />
      </div>

      <div id="areaFromFields" class="input-group" style="display: none">
        <b><label for="fromArea">משטח:</label></b
        ><br />
        <select id="fromArea">
          <option value="m²">📏 מטר רבוע (m²)</option>
          <option value="km²">📏 קילומטר רבוע (km²)</option>
          <option value="acre">📏 אקר (acre)</option>
          <option value="ft²">📏 רגל רבוע (ft²)</option>
          <option value="in²">📏 אינץ' רבוע (in²)</option>
        </select>
      </div>

      <div id="areaToFields" class="input-group" style="display: none">
        <b><label for="toArea">לשטח:</label></b
        ><br />
        <select id="toArea">
          <option value="m²">📏 מטר רבוע (m²)</option>
          <option value="km²">📏 קילומטר רבוע (km²)</option>
          <option value="acre">📏 אקר (acre)</option>
          <option value="ft²">📏 רגל רבוע (ft²)</option>
          <option value="in²">📏 אינץ' רבוע (in²)</option>
        </select>
      </div>

      <!-- שדות להמרת מהירות -->
      <div id="speedFields" class="input-group" style="display: none">
        <b><label for="speedAmount">סכום להמרה:</label></b
        ><br />
        <input type="number" id="speedAmount" placeholder="הכנס סכום" />
      </div>

      <div id="speedFromFields" class="input-group" style="display: none">
        <b><label for="fromSpeed">ממהירות:</label></b
        ><br />
        <select id="fromSpeed">
          <option value="km/h">🚗 קילומטר לשעה (km/h)</option>
          <option value="mph">🚗 מייל לשעה (mph)</option>
          <option value="m/s">🚗 מטר לשנייה (m/s)</option>
          <option value="knot">🚢 קשר (knot)</option>
          <option value="ft/s">🚶 רגל לשנייה (ft/s)</option>
        </select>
      </div>

      <div id="speedToFields" class="input-group" style="display: none">
        <b><label for="toSpeed">למהירות:</label></b
        ><br />
        <select id="toSpeed">
          <option value="km/h">🚗 קילומטר לשעה (km/h)</option>
          <option value="mph">🚗 מייל לשעה (mph)</option>
          <option value="m/s">🚗 מטר לשנייה (m/s)</option>
          <option value="knot">🚢 קשר (knot)</option>
          <option value="ft/s">🚶 רגל לשנייה (ft/s)</option>
        </select>
      </div>

      <button id="convertButton">
        <b>המרה</b>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 256 256"
          width="1em"
          height="1em"
          fill="currentColor"
          style="vertical-align: middle; margin-right: 8px"
        >
          <path
            d="M180.3,9.8c-0.3,0.3-0.7,1.1-0.7,1.6c0,0.5,2.7,8.1,5.9,16.9c3.2,8.8,5.7,16.1,5.5,16.3c-0.2,0.1-41,0.2-90.6,0.2H10.3l-0.2,66.5L10,177.9l1.2-1.2c0.7-0.6,8.3-6.9,16.8-14l15.4-12.9v-34.5V80.6h74h73.9L186,95.2c-6.6,18.1-6.8,18.6-5.8,19.7c0.5,0.5,1.3,0.9,2,0.9c1.1,0,62.5-50.2,63.5-52c0.3-0.5,0.3-1.4,0.2-2c-0.5-1.6-61.8-52.3-63.5-52.5C181.6,9.2,180.7,9.4,180.3,9.8z"
          />
          <path
            d="M229,92.7l-16.5,13.8v34.7v34.8h-73.8c-46,0-73.8-0.2-73.8-0.5c0-0.3,2.6-7.5,5.7-16c3.1-8.5,5.7-16.1,5.7-16.7c0-1.5-1.4-2.7-2.7-2.4c-1.7,0.5-63,51.4-63.4,52.7c-0.2,0.6-0.1,1.5,0.4,2c0.4,0.5,14.6,12.4,31.5,26.4c26.1,21.6,31,25.5,32.3,25.3c1.2-0.1,1.6-0.5,1.7-1.7c0.1-1-2.1-7.8-5.5-17.1c-3.2-8.5-5.7-15.7-5.7-15.9c0-0.2,40.7-0.3,90.5-0.3H246v-66.4c0-36.5-0.1-66.4-0.2-66.4S238.1,85.1,229,92.7z"
          />
        </svg>
      </button>

      <div class="result" id="result"></div>
      <div class="error" id="error"></div>
      <div class="update-time" id="updateTime"></div>

      <!-- היסטוריית המרות -->
      <div class="history">
        <h2>היסטוריית המרות</h2>
        <ul id="historyList"></ul>
      </div>
    </div>

    <!-- Exit Confirmation Modal -->
    <div id="exit-modal">
      <div id="exit-modal-content">
        <h3>האם לצאת?</h3>
        <button id="confirm-exit">יציאה</button>
        <button id="cancel-exit">ביטול</button>
      </div>
    </div>
    <script>
      // מערך לשמירת היסטוריית ההמרות
      let conversionHistory = [];

      // פונקציה להמרת מטבע
      async function convertCurrency() {
        const amount = document.getElementById("amount").value;
        const fromCurrency = document.getElementById("fromCurrency").value;
        const toCurrency = document.getElementById("toCurrency").value;
        const resultDiv = document.getElementById("result");
        const errorDiv = document.getElementById("error");
        const updateTimeDiv = document.getElementById("updateTime");

        // ניקוי תוצאות קודמות
        resultDiv.textContent = "";
        errorDiv.textContent = "";

        // בדיקת תקינות קלט
        if (!amount || isNaN(amount) || amount <= 0) {
          errorDiv.textContent = "אנא הזן סכום חוקי וחיובי.";
          return;
        }

        // בדיקה אם המטבעות זהים
        if (fromCurrency === toCurrency) {
          resultDiv.textContent = `סכום לאחר המרה: ${parseFloat(amount).toFixed(
            2
          )} ${toCurrency}`;
          updateTimeDiv.textContent = `זמן עדכון: ${new Date().toLocaleString(
            "he-IL"
          )}`;
          return;
        }

        try {
          // שימוש ב-AbortController כדי להגביל את זמן הבקשה
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 שניות טיימאאוט

          const apiUrl = `https://api.frankfurter.app/latest?amount=${amount}&from=${fromCurrency}&to=${toCurrency}`;
          const response = await fetch(apiUrl, { signal: controller.signal });

          // ניקוי הטיימר
          clearTimeout(timeoutId);

          if (!response.ok) {
            throw new Error(`שגיאת HTTP: ${response.status}`);
          }

          const data = await response.json();

          // בדיקה שהמטבע קיים בתוצאות
          if (!data.rates[toCurrency]) {
            throw new Error("מטבע יעד לא נתמך.");
          }

          // הצגת התוצאה (API כבר מבצע את החישוב עם הפרמטר amount)
          const convertedAmount = data.rates[toCurrency];
          resultDiv.textContent = `סכום לאחר המרה: ${convertedAmount.toFixed(
            2
          )} ${toCurrency}`;

          // הצגת זמן העדכון האמיתי מה-API (במקום הזמן המקומי)
          const apiUpdateTime = new Date(data.date).toLocaleDateString("he-IL");
          updateTimeDiv.textContent = `זמן עדכון שער : ${apiUpdateTime}`;

          // הוספת ההמרה להיסטוריה
          addToHistory(amount, fromCurrency, toCurrency, convertedAmount);
        } catch (error) {
          // טיפול בשגיאות ספציפיות
          if (error.name === "AbortError") {
            errorDiv.textContent =
              "הבקשה נכשלה בשל זמן תגובה ארוך מדי. נסה שוב.";
          } else {
            console.error("שגיאת API:", error);
            errorDiv.textContent =
              "שגיאה בטעינת נתוני המרה. בדוק מטבעות להמרה.";
          }
        }
      }

      // פונקציה להמרת מרחקים
      function convertDistance() {
        const distanceAmount = document.getElementById("distanceAmount").value;
        const fromDistance = document.getElementById("fromDistance").value;
        const toDistance = document.getElementById("toDistance").value;
        const resultDiv = document.getElementById("result");
        const errorDiv = document.getElementById("error");

        // ניקוי תוצאות קודמות
        resultDiv.textContent = "";
        errorDiv.textContent = "";

        // בדיקת תקינות קלט
        if (!distanceAmount || isNaN(distanceAmount) || distanceAmount <= 0) {
          errorDiv.textContent = "אנא הזן סכום חוקי וחיובי.";
          return;
        }

        // המרת מייל לקילומטר ולהפך
        const mileToKm = 1.60934;
        const inchToCm = 2.54;
        const mileToInch = 63360;
        const kmToCm = 100000;
        const footToInch = 12; // 1 רגל = 12 אינץ'
        const footToCm = 30.48; // 1 רגל = 30.48 סנטימטר
        const yardToInch = 36; // 1 יארד = 36 אינץ'
        const yardToCm = 91.44; // 1 יארד = 91.44 סנטימטר
        const mmToCm = 0.1; // 1 מילימטר = 0.1 סנטימטר
        const cmToMm = 10; // 1 סנטימטר = 10 מילימטר
        let convertedDistance;

        if (fromDistance === "Mile" && toDistance === "Kilometer") {
          convertedDistance = distanceAmount * mileToKm;
        } else if (fromDistance === "Kilometer" && toDistance === "Mile") {
          convertedDistance = distanceAmount / mileToKm;
        } else if (fromDistance === "Inch" && toDistance === "Centimeter") {
          convertedDistance = distanceAmount * inchToCm;
        } else if (fromDistance === "Centimeter" && toDistance === "Inch") {
          convertedDistance = distanceAmount / inchToCm;
        } else if (fromDistance === "Mile" && toDistance === "Inch") {
          convertedDistance = distanceAmount * mileToInch;
        } else if (fromDistance === "Inch" && toDistance === "Mile") {
          convertedDistance = distanceAmount / mileToInch;
        } else if (
          fromDistance === "Kilometer" &&
          toDistance === "Centimeter"
        ) {
          convertedDistance = distanceAmount * kmToCm;
        } else if (
          fromDistance === "Centimeter" &&
          toDistance === "Kilometer"
        ) {
          convertedDistance = distanceAmount / kmToCm;
        } else if (fromDistance === "Mile" && toDistance === "Centimeter") {
          convertedDistance = distanceAmount * mileToKm * kmToCm;
        } else if (fromDistance === "Centimeter" && toDistance === "Mile") {
          convertedDistance = distanceAmount / (mileToKm * kmToCm);
        } else if (fromDistance === "Kilometer" && toDistance === "Inch") {
          convertedDistance = (distanceAmount * kmToCm) / inchToCm;
        } else if (fromDistance === "Inch" && toDistance === "Kilometer") {
          convertedDistance = (distanceAmount * inchToCm) / kmToCm;
        } else if (fromDistance === "foot" && toDistance === "Inch") {
          convertedDistance = distanceAmount * footToInch;
        } else if (fromDistance === "Inch" && toDistance === "foot") {
          convertedDistance = distanceAmount / footToInch;
        } else if (fromDistance === "foot" && toDistance === "Centimeter") {
          convertedDistance = distanceAmount * footToCm;
        } else if (fromDistance === "Centimeter" && toDistance === "foot") {
          convertedDistance = distanceAmount / footToCm;
        } else if (fromDistance === "foot" && toDistance === "Mile") {
          convertedDistance = distanceAmount / (mileToInch / footToInch);
        } else if (fromDistance === "Mile" && toDistance === "foot") {
          convertedDistance = distanceAmount * (mileToInch / footToInch);
        } else if (fromDistance === "foot" && toDistance === "Kilometer") {
          convertedDistance = distanceAmount * (footToCm / kmToCm);
        } else if (fromDistance === "Kilometer" && toDistance === "foot") {
          convertedDistance = distanceAmount / (footToCm / kmToCm);
        } else if (fromDistance === "Yard" && toDistance === "Inch") {
          convertedDistance = distanceAmount * yardToInch;
        } else if (fromDistance === "Inch" && toDistance === "Yard") {
          convertedDistance = distanceAmount / yardToInch;
        } else if (fromDistance === "Yard" && toDistance === "Centimeter") {
          convertedDistance = distanceAmount * yardToCm;
        } else if (fromDistance === "Centimeter" && toDistance === "Yard") {
          convertedDistance = distanceAmount / yardToCm;
        } else if (fromDistance === "Yard" && toDistance === "Mile") {
          convertedDistance = distanceAmount / (mileToInch / yardToInch);
        } else if (fromDistance === "Mile" && toDistance === "Yard") {
          convertedDistance = distanceAmount * (mileToInch / yardToInch);
        } else if (fromDistance === "Yard" && toDistance === "Kilometer") {
          convertedDistance = distanceAmount * (yardToCm / kmToCm);
        } else if (fromDistance === "Kilometer" && toDistance === "Yard") {
          convertedDistance = distanceAmount / (yardToCm / kmToCm);
        } else if (fromDistance === "Yard" && toDistance === "foot") {
          convertedDistance = distanceAmount * 3; // 1 יארד = 3 רגל
        } else if (fromDistance === "foot" && toDistance === "Yard") {
          convertedDistance = distanceAmount / 3; // 1 רגל = 1/3 יארד
        } else if (
          fromDistance === "Millimeter" &&
          toDistance === "Centimeter"
        ) {
          convertedDistance = distanceAmount * mmToCm;
        } else if (
          fromDistance === "Centimeter" &&
          toDistance === "Millimeter"
        ) {
          convertedDistance = distanceAmount * cmToMm;
        } else if (fromDistance === "Millimeter" && toDistance === "Inch") {
          convertedDistance = (distanceAmount * mmToCm) / inchToCm;
        } else if (fromDistance === "Inch" && toDistance === "Millimeter") {
          convertedDistance = (distanceAmount * inchToCm) / mmToCm;
        } else if (
          fromDistance === "Millimeter" &&
          toDistance === "Kilometer"
        ) {
          convertedDistance = (distanceAmount * mmToCm) / kmToCm;
        } else if (
          fromDistance === "Kilometer" &&
          toDistance === "Millimeter"
        ) {
          convertedDistance = (distanceAmount * kmToCm) / mmToCm;
        } else if (fromDistance === "Millimeter" && toDistance === "Mile") {
          convertedDistance = (distanceAmount * mmToCm) / (mileToKm * kmToCm);
        } else if (fromDistance === "Mile" && toDistance === "Millimeter") {
          convertedDistance = (distanceAmount * mileToKm * kmToCm) / mmToCm;
        } else if (fromDistance === "Millimeter" && toDistance === "foot") {
          convertedDistance = (distanceAmount * mmToCm) / footToCm;
        } else if (fromDistance === "foot" && toDistance === "Millimeter") {
          convertedDistance = (distanceAmount * footToCm) / mmToCm;
        } else if (fromDistance === "Millimeter" && toDistance === "Yard") {
          convertedDistance = (distanceAmount * mmToCm) / yardToCm;
        } else if (fromDistance === "Yard" && toDistance === "Millimeter") {
          convertedDistance = (distanceAmount * yardToCm) / mmToCm;
        } else {
          convertedDistance = distanceAmount; // אם היחידות זהות
        }

        // הצגת התוצאה
        resultDiv.textContent = `סכום לאחר המרה: ${convertedDistance.toFixed(
          2
        )} ${toDistance}`;
        resultDiv.style.display = "block"; // לוודא שהתוצאה נראית

        // הוספת ההמרה להיסטוריה
        addToHistory(
          distanceAmount,
          fromDistance,
          toDistance,
          convertedDistance
        );
      }

      // פונקציה להמרת משקלים
      function convertWeight() {
        const weightAmount = document.getElementById("weightAmount").value;
        const fromWeight = document.getElementById("fromWeight").value;
        const toWeight = document.getElementById("toWeight").value;
        const resultDiv = document.getElementById("result");
        const errorDiv = document.getElementById("error");

        // ניקוי תוצאות קודמות
        resultDiv.textContent = "";
        errorDiv.textContent = "";

        // בדיקת תקינות קלט
        if (!weightAmount || isNaN(weightAmount) || weightAmount <= 0) {
          errorDiv.textContent = "אנא הזן סכום חוקי וחיובי.";
          return;
        }

        // המרת פאונד לקילוגרם ולהפך
        const poundToKg = 0.453592;
        const ounceToGram = 28.3495;
        const poundToOunce = 16;
        const kgToGram = 1000;
        let convertedWeight;

        if (fromWeight === "pd" && toWeight === "kg") {
          convertedWeight = weightAmount * poundToKg;
        } else if (fromWeight === "kg" && toWeight === "pd") {
          convertedWeight = weightAmount / poundToKg;
        } else if (fromWeight === "oz" && toWeight === "gr") {
          convertedWeight = weightAmount * ounceToGram;
        } else if (fromWeight === "gr" && toWeight === "oz") {
          convertedWeight = weightAmount / ounceToGram;
        } else if (fromWeight === "pd" && toWeight === "oz") {
          convertedWeight = weightAmount * poundToOunce;
        } else if (fromWeight === "oz" && toWeight === "pd") {
          convertedWeight = weightAmount / poundToOunce;
        } else if (fromWeight === "kg" && toWeight === "gr") {
          convertedWeight = weightAmount * kgToGram;
        } else if (fromWeight === "gr" && toWeight === "kg") {
          convertedWeight = weightAmount / kgToGram;
        } else if (fromWeight === "pd" && toWeight === "gr") {
          convertedWeight = weightAmount * poundToKg * kgToGram;
        } else if (fromWeight === "gr" && toWeight === "pd") {
          convertedWeight = weightAmount / (poundToKg * kgToGram);
        } else if (fromWeight === "kg" && toWeight === "oz") {
          convertedWeight = (weightAmount * kgToGram) / ounceToGram;
        } else if (fromWeight === "oz" && toWeight === "kg") {
          convertedWeight = (weightAmount * ounceToGram) / kgToGram;
        } else {
          convertedWeight = weightAmount; // אם היחידות זהות
        }

        // הצגת התוצאה
        resultDiv.textContent = `סכום לאחר המרה: ${convertedWeight.toFixed(
          2
        )} ${toWeight}`;
        resultDiv.style.display = "block"; // לוודא שהתוצאה נראית

        // הוספת ההמרה להיסטוריה
        addToHistory(weightAmount, fromWeight, toWeight, convertedWeight);
      }

      // פונקציה להמרת טמפרטורה
      function convertTemperature() {
        const temperatureAmount =
          document.getElementById("temperatureAmount").value;
        const fromTemperature =
          document.getElementById("fromTemperature").value;
        const toTemperature = document.getElementById("toTemperature").value;
        const resultDiv = document.getElementById("result");
        const errorDiv = document.getElementById("error");

        // ניקוי תוצאות קודמות
        resultDiv.textContent = "";
        errorDiv.textContent = "";

        // בדיקת תקינות קלט
        if (!temperatureAmount || isNaN(temperatureAmount)) {
          errorDiv.textContent = "אנא הזן סכום חוקי.";
          return;
        }

        let convertedTemperature;

        // המרה מפרנהייט לצלזיוס
        if (fromTemperature === "F" && toTemperature === "C") {
          convertedTemperature = ((temperatureAmount - 32) * 5) / 9;
        }
        // המרה מצלזיוס לפרנהייט
        else if (fromTemperature === "C" && toTemperature === "F") {
          convertedTemperature = (temperatureAmount * 9) / 5 + 32;
        }
        // המרה מפרנהייט לקלווין
        else if (fromTemperature === "F" && toTemperature === "K") {
          convertedTemperature = ((temperatureAmount - 32) * 5) / 9 + 273.15;
        }
        // המרה מקלווין לפרנהייט
        else if (fromTemperature === "K" && toTemperature === "F") {
          convertedTemperature = ((temperatureAmount - 273.15) * 9) / 5 + 32;
        }
        // המרה מצלזיוס לקלווין
        else if (fromTemperature === "C" && toTemperature === "K") {
          convertedTemperature = parseFloat(temperatureAmount) + 273.15;
        }
        // המרה מקלווין לצלזיוס
        else if (fromTemperature === "K" && toTemperature === "C") {
          convertedTemperature = temperatureAmount - 273.15;
        }
        // אם היחידות זהות
        else {
          convertedTemperature = temperatureAmount;
        }

        // הצגת התוצאה
        resultDiv.textContent = `סכום לאחר המרה: ${convertedTemperature.toFixed(
          2
        )} ${toTemperature}`;
        resultDiv.style.display = "block"; // לוודא שהתוצאה נראית

        // הוספת ההמרה להיסטוריה
        addToHistory(
          temperatureAmount,
          fromTemperature,
          toTemperature,
          convertedTemperature
        );
      }

      // פונקציה להמרת נפח
      function convertVolume() {
        const volumeAmount = document.getElementById("volumeAmount").value;
        const fromVolume = document.getElementById("fromVolume").value;
        const toVolume = document.getElementById("toVolume").value;
        const resultDiv = document.getElementById("result");
        const errorDiv = document.getElementById("error");

        // ניקוי תוצאות קודמות
        resultDiv.textContent = "";
        errorDiv.textContent = "";

        // בדיקת תקינות קלט
        if (!volumeAmount || isNaN(volumeAmount) || volumeAmount <= 0) {
          errorDiv.textContent = "אנא הזן סכום חוקי וחיובי.";
          return;
        }

        // המרת ליטר למיליליטר ולהפך
        const literToMl = 1000;
        const gallonToLiter = 3.78541;
        const quartToLiter = 0.946353;
        const pintToLiter = 0.473176; // 1 פינט = 0.473176 ליטר
        const flOzToMl = 29.5735;
        let convertedVolume;

        if (fromVolume === "L" && toVolume === "mL") {
          convertedVolume = volumeAmount * literToMl;
        } else if (fromVolume === "mL" && toVolume === "L") {
          convertedVolume = volumeAmount / literToMl;
        } else if (fromVolume === "gal" && toVolume === "L") {
          convertedVolume = volumeAmount * gallonToLiter;
        } else if (fromVolume === "L" && toVolume === "gal") {
          convertedVolume = volumeAmount / gallonToLiter;
        } else if (fromVolume === "qt" && toVolume === "L") {
          convertedVolume = volumeAmount * quartToLiter;
        } else if (fromVolume === "L" && toVolume === "qt") {
          convertedVolume = volumeAmount / quartToLiter;
        } else if (fromVolume === "pt" && toVolume === "L") {
          convertedVolume = volumeAmount * pintToLiter;
        } else if (fromVolume === "L" && toVolume === "pt") {
          convertedVolume = volumeAmount / pintToLiter;
        } else if (fromVolume === "fl oz" && toVolume === "mL") {
          convertedVolume = volumeAmount * flOzToMl;
        } else if (fromVolume === "mL" && toVolume === "fl oz") {
          convertedVolume = volumeAmount / flOzToMl;
        } else if (fromVolume === "pt" && toVolume === "mL") {
          convertedVolume = volumeAmount * pintToLiter * literToMl; // פינט לליטר ואז ל-mL
        } else if (fromVolume === "mL" && toVolume === "pt") {
          convertedVolume = volumeAmount / (pintToLiter * literToMl); // mL לליטר ואז לפינט
        } else {
          convertedVolume = volumeAmount; // אם היחידות זהות
        }

        // הצגת התוצאה
        resultDiv.textContent = `סכום לאחר המרה: ${convertedVolume.toFixed(
          2
        )} ${toVolume}`;
        resultDiv.style.display = "block"; // לוודא שהתוצאה נראית

        // הוספת ההמרה להיסטוריה
        addToHistory(volumeAmount, fromVolume, toVolume, convertedVolume);
      }

      // פונקציה להמרת שטח
      function convertArea() {
        const areaAmount = document.getElementById("areaAmount").value;
        const fromArea = document.getElementById("fromArea").value;
        const toArea = document.getElementById("toArea").value;
        const resultDiv = document.getElementById("result");
        const errorDiv = document.getElementById("error");

        // ניקוי תוצאות קודמות
        resultDiv.textContent = "";
        errorDiv.textContent = "";

        // בדיקת תקינות קלט
        if (!areaAmount || isNaN(areaAmount) || areaAmount <= 0) {
          errorDiv.textContent = "אנא הזן סכום חוקי וחיובי.";
          return;
        }

        // המרת מטר רבוע לקילומטר רבוע ולהפך
        const meterSqToKmSq = 0.000001;
        const acreToMeterSq = 4046.86;
        const footSqToMeterSq = 0.092903;
        const inchSqToMeterSq = 0.00064516;
        let convertedArea;

        if (fromArea === "m²" && toArea === "km²") {
          convertedArea = areaAmount * meterSqToKmSq;
        } else if (fromArea === "km²" && toArea === "m²") {
          convertedArea = areaAmount / meterSqToKmSq;
        } else if (fromArea === "acre" && toArea === "m²") {
          convertedArea = areaAmount * acreToMeterSq;
        } else if (fromArea === "m²" && toArea === "acre") {
          convertedArea = areaAmount / acreToMeterSq;
        } else if (fromArea === "ft²" && toArea === "m²") {
          convertedArea = areaAmount * footSqToMeterSq;
        } else if (fromArea === "m²" && toArea === "ft²") {
          convertedArea = areaAmount / footSqToMeterSq;
        } else if (fromArea === "in²" && toArea === "m²") {
          convertedArea = areaAmount * inchSqToMeterSq;
        } else if (fromArea === "m²" && toArea === "in²") {
          convertedArea = areaAmount / inchSqToMeterSq;
        } else if (fromArea === "acre" && toArea === "km²") {
          convertedArea = areaAmount * (acreToMeterSq * meterSqToKmSq);
        } else if (fromArea === "km²" && toArea === "acre") {
          convertedArea = areaAmount / (acreToMeterSq * meterSqToKmSq);
        } else if (fromArea === "ft²" && toArea === "km²") {
          convertedArea = areaAmount * (footSqToMeterSq * meterSqToKmSq);
        } else if (fromArea === "km²" && toArea === "ft²") {
          convertedArea = areaAmount / (footSqToMeterSq * meterSqToKmSq);
        } else if (fromArea === "in²" && toArea === "km²") {
          convertedArea = areaAmount * (inchSqToMeterSq * meterSqToKmSq);
        } else if (fromArea === "km²" && toArea === "in²") {
          convertedArea = areaAmount / (inchSqToMeterSq * meterSqToKmSq);
        } else if (fromArea === "acre" && toArea === "ft²") {
          convertedArea = areaAmount * (acreToMeterSq / footSqToMeterSq);
        } else if (fromArea === "ft²" && toArea === "acre") {
          convertedArea = areaAmount / (acreToMeterSq / footSqToMeterSq);
        } else if (fromArea === "acre" && toArea === "in²") {
          convertedArea = areaAmount * (acreToMeterSq / inchSqToMeterSq);
        } else if (fromArea === "in²" && toArea === "acre") {
          convertedArea = areaAmount / (acreToMeterSq / inchSqToMeterSq);
        } else if (fromArea === "ft²" && toArea === "in²") {
          convertedArea = areaAmount * 144; // 1 רגל רבוע = 144 אינץ' רבוע
        } else if (fromArea === "in²" && toArea === "ft²") {
          convertedArea = areaAmount / 144;
        } else {
          convertedArea = areaAmount; // אם היחידות זהות
        }

        // הצגת התוצאה
        resultDiv.textContent = `סכום לאחר המרה: ${convertedArea.toFixed(
          2
        )} ${toArea}`;
        resultDiv.style.display = "block"; // לוודא שהתוצאה נראית

        // הוספת ההמרה להיסטוריה
        addToHistory(areaAmount, fromArea, toArea, convertedArea);
      }

      // פונקציה להמרת מהירות
      function convertSpeed() {
        const speedAmount = document.getElementById("speedAmount").value;
        const fromSpeed = document.getElementById("fromSpeed").value;
        const toSpeed = document.getElementById("toSpeed").value;
        const resultDiv = document.getElementById("result");
        const errorDiv = document.getElementById("error");

        // ניקוי תוצאות קודמות
        resultDiv.textContent = "";
        errorDiv.textContent = "";

        // בדיקת תקינות קלט
        if (!speedAmount || isNaN(speedAmount) || speedAmount <= 0) {
          errorDiv.textContent = "אנא הזן סכום חוקי וחיובי.";
          return;
        }

        // המרת מהירות
        const kmhToMph = 0.621371; // 1 קמ"ש = 0.621371 מייל לשעה
        const kmhToMs = 0.277778; // 1 קמ"ש = 0.277778 מטר לשנייה
        const kmhToKnot = 0.539957; // 1 קמ"ש = 0.539957 קשר
        const kmhToFts = 0.911344; // 1 קמ"ש = 0.911344 רגל לשנייה
        let convertedSpeed;

        if (fromSpeed === "km/h" && toSpeed === "mph") {
          convertedSpeed = speedAmount * kmhToMph;
        } else if (fromSpeed === "mph" && toSpeed === "km/h") {
          convertedSpeed = speedAmount / kmhToMph;
        } else if (fromSpeed === "km/h" && toSpeed === "m/s") {
          convertedSpeed = speedAmount * kmhToMs;
        } else if (fromSpeed === "m/s" && toSpeed === "km/h") {
          convertedSpeed = speedAmount / kmhToMs;
        } else if (fromSpeed === "km/h" && toSpeed === "knot") {
          convertedSpeed = speedAmount * kmhToKnot;
        } else if (fromSpeed === "knot" && toSpeed === "km/h") {
          convertedSpeed = speedAmount / kmhToKnot;
        } else if (fromSpeed === "km/h" && toSpeed === "ft/s") {
          convertedSpeed = speedAmount * kmhToFts;
        } else if (fromSpeed === "ft/s" && toSpeed === "km/h") {
          convertedSpeed = speedAmount / kmhToFts;
        } else if (fromSpeed === "mph" && toSpeed === "m/s") {
          convertedSpeed = (speedAmount / kmhToMph) * kmhToMs;
        } else if (fromSpeed === "m/s" && toSpeed === "mph") {
          convertedSpeed = (speedAmount / kmhToMs) * kmhToMph;
        } else if (fromSpeed === "mph" && toSpeed === "knot") {
          convertedSpeed = (speedAmount / kmhToMph) * kmhToKnot;
        } else if (fromSpeed === "knot" && toSpeed === "mph") {
          convertedSpeed = (speedAmount / kmhToKnot) * kmhToMph;
        } else if (fromSpeed === "mph" && toSpeed === "ft/s") {
          convertedSpeed = (speedAmount / kmhToMph) * kmhToFts;
        } else if (fromSpeed === "ft/s" && toSpeed === "mph") {
          convertedSpeed = (speedAmount / kmhToFts) * kmhToMph;
        } else if (fromSpeed === "m/s" && toSpeed === "knot") {
          convertedSpeed = (speedAmount / kmhToMs) * kmhToKnot;
        } else if (fromSpeed === "knot" && toSpeed === "m/s") {
          convertedSpeed = (speedAmount / kmhToKnot) * kmhToMs;
        } else if (fromSpeed === "m/s" && toSpeed === "ft/s") {
          convertedSpeed = (speedAmount / kmhToMs) * kmhToFts;
        } else if (fromSpeed === "ft/s" && toSpeed === "m/s") {
          convertedSpeed = (speedAmount / kmhToFts) * kmhToMs;
        } else if (fromSpeed === "knot" && toSpeed === "ft/s") {
          convertedSpeed = (speedAmount / kmhToKnot) * kmhToFts;
        } else if (fromSpeed === "ft/s" && toSpeed === "knot") {
          convertedSpeed = (speedAmount / kmhToFts) * kmhToKnot;
        } else {
          convertedSpeed = speedAmount; // אם היחידות זהות
        }

        // הצגת התוצאה
        resultDiv.textContent = `סכום לאחר המרה: ${convertedSpeed.toFixed(
          2
        )} ${toSpeed}`;
        resultDiv.style.display = "block"; // לוודא שהתוצאה נראית

        // הוספת ההמרה להיסטוריה
        addToHistory(speedAmount, fromSpeed, toSpeed, convertedSpeed);
      }

      // פונקציה להוספת המרה להיסטוריה
      function addToHistory(amount, fromUnit, toUnit, convertedAmount) {
        const historyEntry = {
          amount: parseFloat(amount), // המרה למספר
          fromUnit: fromUnit,
          toUnit: toUnit,
          convertedAmount: parseFloat(convertedAmount), // המרה למספר
          date: new Date().toLocaleString("he-IL"),
        };

        // הוספת ההמרה למערך ההיסטוריה
        conversionHistory.push(historyEntry);

        // שמירת ההיסטוריה ב-localStorage
        localStorage.setItem(
          "conversionHistory",
          JSON.stringify(conversionHistory)
        );

        // עדכון התצוגה של ההיסטוריה
        updateHistoryDisplay();
      }

      // פונקציה לעדכון תצוגת ההיסטוריה
      function updateHistoryDisplay() {
        const historyList = document.getElementById("historyList");
        historyList.innerHTML = "";

        if (conversionHistory.length === 0) {
          const li = document.createElement("li");
          li.textContent = ".אין המרות בהיסטוריה";
          historyList.appendChild(li);
        } else {
          // יצירת רשימת ההיסטוריה בסדר הפוך (הכי חדש למעלה)
          const reversedHistory = [...conversionHistory].reverse(); // הפיכת הסדר
          reversedHistory.forEach((entry) => {
            const li = document.createElement("li");
            const conversionText = document.createElement("div");
            const dateText = document.createElement("div");

            conversionText.textContent = `${entry.amount} ${
              entry.fromUnit
            } → ${parseFloat(entry.convertedAmount).toFixed(2)} ${
              entry.toUnit
            }`;
            historyList.appendChild(li); // לוודא שההיסטוריה מתעדכנת
            dateText.textContent = `(${entry.date})`;

            // הוספת הטקסטים ל-li
            li.appendChild(conversionText);
            li.appendChild(dateText);

            // הוספת ה-li לרשימה
            historyList.appendChild(li);
          });
        }
      }

      // פונקציה לנקוי היסטוריית ההמרות
      function clearHistory() {
        // איפוס מערך ההיסטוריה
        conversionHistory = [];

        // ניקוי היסטוריה מה-localStorage
        localStorage.removeItem("conversionHistory");

        // עדכון התצוגה של ההיסטוריה
        updateHistoryDisplay();
      }

      // פונקציה להחלפת מטבעות המקור והיעד
      function toggleConversion() {
        const fromCurrency = document.getElementById("fromCurrency");
        const toCurrency = document.getElementById("toCurrency");

        // הופכים את הערכים בין תיבות הגלילה
        const temp = fromCurrency.value;
        fromCurrency.value = toCurrency.value;
        toCurrency.value = temp;

        // מבצעים את ההמרה מחדש רק אם יש סכום
        if (document.getElementById("amount").value) {
          convertCurrency();
        }
      }

      // פונקציה להחלפת שדות מרחק וחישוב מחדש
      function toggleDistanceConversion() {
        const fromDistance = document.getElementById("fromDistance");
        const toDistance = document.getElementById("toDistance");

        // הופכים את הערכים בין תיבות הגלילה
        const temp = fromDistance.value;
        fromDistance.value = toDistance.value;
        toDistance.value = temp;

        // מבצעים את ההמרה מחדש רק אם יש סכום
        if (document.getElementById("distanceAmount").value) {
          convertDistance();
        }
      }

      // פונקציה להחלפת שדות משקלים וחישוב מחדש
      function toggleWeightConversion() {
        const fromWeight = document.getElementById("fromWeight");
        const toWeight = document.getElementById("toWeight");

        // הופכים את הערכים בין תיבות הגלילה
        const temp = fromWeight.value;
        fromWeight.value = toWeight.value;
        toWeight.value = temp;

        // מבצעים את ההמרה מחדש רק אם יש סכום
        if (document.getElementById("weightAmount").value) {
          convertWeight();
        }
      }

      // פונקציה להחלפת שדות טמפרטורה וחישוב מחדש
      function toggleTemperatureConversion() {
        const fromTemperature = document.getElementById("fromTemperature");
        const toTemperature = document.getElementById("toTemperature");

        // הופכים את הערכים בין תיבות הגלילה
        const temp = fromTemperature.value;
        fromTemperature.value = toTemperature.value;
        toTemperature.value = temp;

        // מבצעים את ההמרה מחדש רק אם יש סכום
        if (document.getElementById("temperatureAmount").value) {
          convertTemperature();
        }
      }

      // פונקציה להחלפת שדות נפח וחישוב מחדש
      function toggleVolumeConversion() {
        const fromVolume = document.getElementById("fromVolume");
        const toVolume = document.getElementById("toVolume");

        // הופכים את הערכים בין תיבות הגלילה
        const temp = fromVolume.value;
        fromVolume.value = toVolume.value;
        toVolume.value = temp;

        // מבצעים את ההמרה מחדש רק אם יש סכום
        if (document.getElementById("volumeAmount").value) {
          convertVolume();
        }
      }

      // פונקציה להחלפת שדות שטח וחישוב מחדש
      function toggleAreaConversion() {
        const fromArea = document.getElementById("fromArea");
        const toArea = document.getElementById("toArea");

        // הופכים את הערכים בין תיבות הגלילה
        const temp = fromArea.value;
        fromArea.value = toArea.value;
        toArea.value = temp;

        // מבצעים את ההמרה מחדש רק אם יש סכום
        if (document.getElementById("areaAmount").value) {
          convertArea();
        }
      }

      // פונקציה להחלפת שדות מהירות וחישוב מחדש
      function toggleSpeedConversion() {
        const fromSpeed = document.getElementById("fromSpeed");
        const toSpeed = document.getElementById("toSpeed");

        // הופכים את הערכים בין תיבות הגלילה
        const temp = fromSpeed.value;
        fromSpeed.value = toSpeed.value;
        toSpeed.value = temp;

        // מבצעים את ההמרה מחדש רק אם יש סכום
        if (document.getElementById("speedAmount").value) {
          convertSpeed();
        }
      }

      // פונקציה להחלפת ערכת הצבעים
      function toggleTheme() {
        const body = document.body;
        const themeToggle = document.getElementById("themeToggle");

        if (body.classList.contains("dark-theme")) {
          body.classList.remove("dark-theme");
          body.classList.add("light-theme");
          themeToggle.textContent = "🌞";
        } else {
          body.classList.remove("light-theme");
          body.classList.add("dark-theme");
          themeToggle.textContent = "🌙";
        }

        // עדכון תצוגת ההיסטוריה לאחר שינוי ערכת הצבעים
        updateHistoryDisplay();
      }

      // פונקציה לשינוי סוג ההמרה
      function changeConversionType() {
        const conversionType = document.getElementById("conversionType").value;
        const currencyFields = document.getElementById("currencyFields");
        const currencyFromFields =
          document.getElementById("currencyFromFields");
        const currencyToFields = document.getElementById("currencyToFields");
        const distanceFields = document.getElementById("distanceFields");
        const distanceFromFields =
          document.getElementById("distanceFromFields");
        const distanceToFields = document.getElementById("distanceToFields");
        const weightFields = document.getElementById("weightFields");
        const weightFromFields = document.getElementById("weightFromFields");
        const weightToFields = document.getElementById("weightToFields");
        const temperatureFields = document.getElementById("temperatureFields");
        const temperatureFromFields = document.getElementById(
          "temperatureFromFields"
        );
        const temperatureToFields = document.getElementById(
          "temperatureToFields"
        );
        const volumeFields = document.getElementById("volumeFields");
        const volumeFromFields = document.getElementById("volumeFromFields");
        const volumeToFields = document.getElementById("volumeToFields");
        const areaFields = document.getElementById("areaFields");
        const areaFromFields = document.getElementById("areaFromFields");
        const areaToFields = document.getElementById("areaToFields");
        const speedFields = document.getElementById("speedFields");
        const speedFromFields = document.getElementById("speedFromFields");
        const speedToFields = document.getElementById("speedToFields");
        const resultDiv = document.getElementById("result");
        const errorDiv = document.getElementById("error");

        // ניקוי תוצאות קודמות והיסטוריה
        resultDiv.textContent = "";
        errorDiv.textContent = "";
        clearHistory(); // מחיקת ההיסטוריה בעת מעבר לקטגוריה חדשה

        if (conversionType === "currency") {
          currencyFields.style.display = "block";
          currencyFromFields.style.display = "block";
          currencyToFields.style.display = "block";
          distanceFields.style.display = "none";
          distanceFromFields.style.display = "none";
          distanceToFields.style.display = "none";
          weightFields.style.display = "none";
          weightFromFields.style.display = "none";
          weightToFields.style.display = "none";
          temperatureFields.style.display = "none";
          temperatureFromFields.style.display = "none";
          temperatureToFields.style.display = "none";
          volumeFields.style.display = "none";
          volumeFromFields.style.display = "none";
          volumeToFields.style.display = "none";
          areaFields.style.display = "none";
          areaFromFields.style.display = "none";
          areaToFields.style.display = "none";
          speedFields.style.display = "none";
          speedFromFields.style.display = "none";
          speedToFields.style.display = "none";
        } else if (conversionType === "distance") {
          currencyFields.style.display = "none";
          currencyFromFields.style.display = "none";
          currencyToFields.style.display = "none";
          distanceFields.style.display = "block";
          distanceFromFields.style.display = "block";
          distanceToFields.style.display = "block";
          weightFields.style.display = "none";
          weightFromFields.style.display = "none";
          weightToFields.style.display = "none";
          temperatureFields.style.display = "none";
          temperatureFromFields.style.display = "none";
          temperatureToFields.style.display = "none";
          volumeFields.style.display = "none";
          volumeFromFields.style.display = "none";
          volumeToFields.style.display = "none";
          areaFields.style.display = "none";
          areaFromFields.style.display = "none";
          areaToFields.style.display = "none";
          speedFields.style.display = "none";
          speedFromFields.style.display = "none";
          speedToFields.style.display = "none";
        } else if (conversionType === "weight") {
          currencyFields.style.display = "none";
          currencyFromFields.style.display = "none";
          currencyToFields.style.display = "none";
          distanceFields.style.display = "none";
          distanceFromFields.style.display = "none";
          distanceToFields.style.display = "none";
          weightFields.style.display = "block";
          weightFromFields.style.display = "block";
          weightToFields.style.display = "block";
          temperatureFields.style.display = "none";
          temperatureFromFields.style.display = "none";
          temperatureToFields.style.display = "none";
          volumeFields.style.display = "none";
          volumeFromFields.style.display = "none";
          volumeToFields.style.display = "none";
          areaFields.style.display = "none";
          areaFromFields.style.display = "none";
          areaToFields.style.display = "none";
          speedFields.style.display = "none";
          speedFromFields.style.display = "none";
          speedToFields.style.display = "none";
        } else if (conversionType === "temperature") {
          currencyFields.style.display = "none";
          currencyFromFields.style.display = "none";
          currencyToFields.style.display = "none";
          distanceFields.style.display = "none";
          distanceFromFields.style.display = "none";
          distanceToFields.style.display = "none";
          weightFields.style.display = "none";
          weightFromFields.style.display = "none";
          weightToFields.style.display = "none";
          temperatureFields.style.display = "block";
          temperatureFromFields.style.display = "block";
          temperatureToFields.style.display = "block";
          volumeFields.style.display = "none";
          volumeFromFields.style.display = "none";
          volumeToFields.style.display = "none";
          areaFields.style.display = "none";
          areaFromFields.style.display = "none";
          areaToFields.style.display = "none";
          speedFields.style.display = "none";
          speedFromFields.style.display = "none";
          speedToFields.style.display = "none";
        } else if (conversionType === "volume") {
          currencyFields.style.display = "none";
          currencyFromFields.style.display = "none";
          currencyToFields.style.display = "none";
          distanceFields.style.display = "none";
          distanceFromFields.style.display = "none";
          distanceToFields.style.display = "none";
          weightFields.style.display = "none";
          weightFromFields.style.display = "none";
          weightToFields.style.display = "none";
          temperatureFields.style.display = "none";
          temperatureFromFields.style.display = "none";
          temperatureToFields.style.display = "none";
          volumeFields.style.display = "block";
          volumeFromFields.style.display = "block";
          volumeToFields.style.display = "block";
          areaFields.style.display = "none";
          areaFromFields.style.display = "none";
          areaToFields.style.display = "none";
          speedFields.style.display = "none";
          speedFromFields.style.display = "none";
          speedToFields.style.display = "none";
        } else if (conversionType === "area") {
          currencyFields.style.display = "none";
          currencyFromFields.style.display = "none";
          currencyToFields.style.display = "none";
          distanceFields.style.display = "none";
          distanceFromFields.style.display = "none";
          distanceToFields.style.display = "none";
          weightFields.style.display = "none";
          weightFromFields.style.display = "none";
          weightToFields.style.display = "none";
          temperatureFields.style.display = "none";
          temperatureFromFields.style.display = "none";
          temperatureToFields.style.display = "none";
          volumeFields.style.display = "none";
          volumeFromFields.style.display = "none";
          volumeToFields.style.display = "none";
          areaFields.style.display = "block";
          areaFromFields.style.display = "block";
          areaToFields.style.display = "block";
          speedFields.style.display = "none";
          speedFromFields.style.display = "none";
          speedToFields.style.display = "none";
        } else if (conversionType === "speed") {
          currencyFields.style.display = "none";
          currencyFromFields.style.display = "none";
          currencyToFields.style.display = "none";
          distanceFields.style.display = "none";
          distanceFromFields.style.display = "none";
          distanceToFields.style.display = "none";
          weightFields.style.display = "none";
          weightFromFields.style.display = "none";
          weightToFields.style.display = "none";
          temperatureFields.style.display = "none";
          temperatureFromFields.style.display = "none";
          temperatureToFields.style.display = "none";
          volumeFields.style.display = "none";
          volumeFromFields.style.display = "none";
          volumeToFields.style.display = "none";
          areaFields.style.display = "none";
          areaFromFields.style.display = "none";
          areaToFields.style.display = "none";
          speedFields.style.display = "block";
          speedFromFields.style.display = "block";
          speedToFields.style.display = "block";
        }
      }

      // פונקציה להפניה לדף אחר
      function exitApplication() {
        window.location.href = "index.html";
      }

      // הצגת הדיאלוג הקיים מהקובץ CSS
      function showExitDialog() {
        const exitModal = document.getElementById("exit-modal");
        if (exitModal) {
          exitModal.style.display = "flex";
        }
      }

      // הסתרת הדיאלוג
      function hideExitDialog() {
        const exitModal = document.getElementById("exit-modal");
        if (exitModal) {
          exitModal.style.display = "none";
        }
      }

      // טיפול בלחיצות כפתורים
      document
        .getElementById("confirm-exit")
        ?.addEventListener("click", exitApplication);
      document
        .getElementById("cancel-exit")
        ?.addEventListener("click", hideExitDialog);

      // מאזין ללחיצת אחורה
      window.addEventListener("popstate", function (event) {
        showExitDialog();
        history.pushState(null, null, window.location.pathname);
      });

      // אתחול היסטוריה
      history.pushState(null, null, window.location.pathname);

      // פונקציית אתחול
      function initApp() {
        // הגדרת האפליקציה תמיד לפתוח במצב ברירת המחדל (כהה)
        document.body.classList.add("dark-theme");
        document.getElementById("themeToggle").textContent = "🌙";

        // טעינת היסטוריית ההמרות מהאחסון המקומי
        const savedHistory = localStorage.getItem("conversionHistory");
        if (savedHistory) {
          conversionHistory = JSON.parse(savedHistory);
          updateHistoryDisplay();
        }

        // הגדרת ברירת מחדל למטבעות
        document.getElementById("toCurrency").value = "ILS";
        document.getElementById("fromCurrency").value = "USD";

        // הגדרת ברירת מחדל למרחקים
        document.getElementById("fromDistance").value = "Mile"; // ממידה: מייל
        document.getElementById("toDistance").value = "Kilometer"; // למידה: קילומטר

        // הגדרת ברירת מחדל למשקלים
        document.getElementById("fromWeight").value = "pd"; // ממשקל: פאונד
        document.getElementById("toWeight").value = "kg"; // למשקל: קילוגרם

        // הגדרת ברירת מחדל לטמפרטורה
        document.getElementById("fromTemperature").value = "F"; // לטמפרטורה: פרנהייט
        document.getElementById("toTemperature").value = "C"; // מטמפרטורה: צלזיוס

        // הגדרת ברירת מחדל לנפח
        document.getElementById("fromVolume").value = "gal"; // מנפח: גלון
        document.getElementById("toVolume").value = "L"; // לנפח: ליטר

        // הגדרת ברירת מחדל לשטח
        document.getElementById("fromArea").value = "acre"; // משטח: מטר רבוע
        document.getElementById("toArea").value = "km²"; // לשטח: קילומטר רבוע

        // הגדרת ברירת מחדל למהירות
        document.getElementById("fromSpeed").value = "km/h"; // ממהירות: קילומטר לשעה
        document.getElementById("toSpeed").value = "mph"; // למהירות: מייל לשעה

        // הוספת אירוע ללחיצה על כפתור שינוי התצוגה
        document
          .getElementById("themeToggle")
          .addEventListener("click", toggleTheme);

        // הוספת אירוע ללחיצה על כפתור ניקוי היסטוריה
        document
          .getElementById("clearHistoryButton")
          .addEventListener("click", clearHistory);

        // הוספת אירועי שינוי לאלמנטים
        document
          .getElementById("amount")
          .addEventListener("input", convertCurrency); // חישוב מיידי בהכנסת סכום
        document
          .getElementById("fromCurrency")
          .addEventListener("change", convertCurrency);
        document
          .getElementById("toCurrency")
          .addEventListener("change", convertCurrency);

        // הוספת אירוע input לשדה הסכום להמרה במרחקים
        document
          .getElementById("distanceAmount")
          .addEventListener("input", convertDistance);
        document
          .getElementById("fromDistance")
          .addEventListener("change", convertDistance);
        document
          .getElementById("toDistance")
          .addEventListener("change", convertDistance);

        // הוספת אירוע input לשדה הסכום להמרה במשקלים
        document
          .getElementById("weightAmount")
          .addEventListener("input", convertWeight);
        document
          .getElementById("fromWeight")
          .addEventListener("change", convertWeight);
        document
          .getElementById("toWeight")
          .addEventListener("change", convertWeight);

        // הוספת אירוע input לשדה הסכום להמרה בטמפרטורה
        document
          .getElementById("temperatureAmount")
          .addEventListener("input", convertTemperature);
        document
          .getElementById("fromTemperature")
          .addEventListener("change", convertTemperature);
        document
          .getElementById("toTemperature")
          .addEventListener("change", convertTemperature);

        // הוספת אירוע input לשדה הסכום להמרה בנפח
        document
          .getElementById("volumeAmount")
          .addEventListener("input", convertVolume);
        document
          .getElementById("fromVolume")
          .addEventListener("change", convertVolume);
        document
          .getElementById("toVolume")
          .addEventListener("change", convertVolume);

        // הוספת אירוע input לשדה הסכום להמרה בשטח
        document
          .getElementById("areaAmount")
          .addEventListener("input", convertArea);
        document
          .getElementById("fromArea")
          .addEventListener("change", convertArea);
        document
          .getElementById("toArea")
          .addEventListener("change", convertArea);

        // הוספת אירוע input לשדה הסכום להמרה במהירות
        document
          .getElementById("speedAmount")
          .addEventListener("input", convertSpeed);
        document
          .getElementById("fromSpeed")
          .addEventListener("change", convertSpeed);
        document
          .getElementById("toSpeed")
          .addEventListener("change", convertSpeed);

        // הוספת אירוע ללחיצה על כפתור ההמרה
        document
          .getElementById("convertButton")
          .addEventListener("click", function () {
            const conversionType =
              document.getElementById("conversionType").value;

            if (conversionType === "distance") {
              toggleDistanceConversion(); // הפיכת שדות מרחק וחישוב מחדש
            } else if (conversionType === "currency") {
              toggleConversion(); // הפיכת שדות מטבעות וחישוב מחדש
            } else if (conversionType === "weight") {
              toggleWeightConversion(); // הפיכת שדות משקלים וחישוב מחדש
            } else if (conversionType === "temperature") {
              toggleTemperatureConversion(); // הפיכת שדות טמפרטורה וחישוב מחדש
            } else if (conversionType === "volume") {
              toggleVolumeConversion(); // הפיכת שדות נפח וחישוב מחדש
            } else if (conversionType === "area") {
              toggleAreaConversion(); // הפיכת שדות שטח וחישוב מחדש
            } else if (conversionType === "speed") {
              toggleSpeedConversion(); // הפיכת שדות מהירות וחישוב מחדש
            }
          });

        // הגדרת ברירת מחדל לסוג ההמרה
        changeConversionType();

        // אתחול מערכת היציאה מהאפליקציה
        // הוספת אתחול היסטוריה לדף
        history.pushState(null, null, window.location.pathname);

        // הוספת מאזין ללחיצת אחורה
        window.addEventListener("popstate", function (event) {
          showExitDialog();
          history.pushState(null, null, window.location.pathname);
        });

        // טיפול בלחיצות כפתורי היציאה
        document
          .getElementById("confirm-exit")
          ?.addEventListener("click", exitApplication);
        document
          .getElementById("cancel-exit")
          ?.addEventListener("click", hideExitDialog);
      }

      // הפעלת האתחול כאשר המסמך טעון
      document.addEventListener("DOMContentLoaded", initApp);
    </script>
  </body>
</html>
